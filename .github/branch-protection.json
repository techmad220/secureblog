{
  "_metadata": {
    "description": "Branch protection rules for SecureBlog - apply via GitHub CLI or API",
    "usage": "gh api repos/:owner/:repo/branches/main/protection --method PUT --input branch-protection.json",
    "last_updated": "2024-01-01"
  },
  
  "required_status_checks": {
    "strict": true,
    "checks": [
      {
        "context": "ci",
        "app_id": null
      },
      {
        "context": "security-regression-guard", 
        "app_id": null
      },
      {
        "context": "codeql",
        "app_id": null
      },
      {
        "context": "dependency-review",
        "app_id": null
      },
      {
        "context": "slsa-provenance / build",
        "app_id": null
      },
      {
        "context": "slsa-provenance / verify-provenance", 
        "app_id": null
      }
    ]
  },
  
  "enforce_admins": true,
  "required_pull_request_reviews": {
    "required_approving_review_count": 2,
    "dismiss_stale_reviews": true,
    "require_code_owner_reviews": true,
    "require_last_push_approval": true,
    "bypass_pull_request_allowances": {
      "users": [],
      "teams": [],
      "apps": []
    }
  },
  
  "restrictions": null,
  "required_linear_history": true,
  "allow_force_pushes": false,
  "allow_deletions": false,
  
  "required_conversation_resolution": true,
  "lock_branch": false,
  "allow_fork_syncing": false,
  
  "block_creations": false
}